$(document).ready(function(){$.event.props=$.event.props.join("|").replace("layerX|layerY|","").split("|");global.contactListObj=$("#contact_list");global.searchObj=$("#searchEvent");global.searchObj.focus(function(){global.searchTxt=global.searchObj.val();global.intervalObj=setInterval(searchHandle,300)}).blur(function(){clearInterval(global.intervalObj)})});var global={contactListObj:"",bRefresh:true,searchObj:"",searchTxt:"",intervalObj:""};document.oncontextmenu=new Function("return false;");window.onload=function(){global.bRefresh=true;parent.iframeContactRefresh()};function searchHandle(){var a=global.searchObj.val();if(a!=global.searchTxt){global.searchTxt=a;a=global.searchObj.val();if(a==""){cef.cloud("getAllContacts")}else{cef.param=a;cef.cloud("searchContacts")}}}function connectSuccess(){if(global.bRefresh){return}setTopmenu()}function save(){if($("#saveContacts").hasClass("disable")){return}var c="";var b=global.contactListObj.find(".select_on").parent().parent();var a=0;b.each(function(){if(a==0){c=$(this).attr("id")}else{c=c+","+$(this).attr("id")}a++});if(c!=""){parent.iframeSaveContacts(c)}}function import2phone(){if($("#import2Phone").hasClass("disable")){return}var c="";var b=global.contactListObj.find(".select_on").parent().parent();var a=0;b.each(function(){if(a==0){c=$(this).attr("id")}else{c=c+","+$(this).attr("id")}a++});if(c!=""){parent.iframeImportContacts2Phone(c,a)}}function refresh(){if($("#refresh").hasClass("disable")){return}document.getElementById("saveContacts").className="menu-nav disable";document.getElementById("import2Phone").className="menu-nav disable";document.getElementById("refresh").className="menu-nav disable";document.getElementById("contact_list").innerHTML="";document.getElementById("loadding").innerText="正在加载云联系人，请稍候！";document.getElementById("loadding").style.display="block";document.getElementById("fail").style.display="none";document.getElementById("contactItemDetail").innerHTML="";$("#contactName").text("");global.bRefresh=true;$("#searchEvent").attr("disabled","disabled").val("");global.searchTxt="";parent.iframeContactRefresh()}function setContactsList(a){document.getElementById("refresh").className="menu-nav";global.bRefresh=false;var e=$("#contact_list");if(a=="0"){parent.iframeSetContactNum("0");$("#searchEvent").attr("disabled","disabled");document.getElementById("fail").style.display="block";return}else{if(a=="1"){parent.iframeSetContactNum("0");$("#searchEvent").removeAttr("disabled");document.getElementById("contact_list").innerHTML="";document.getElementById("loadding").style.display="none";return}}if(a!=""&&a!=null){$("#searchEvent").removeAttr("disabled");var b="";for(var c=0;c<a.length;c++){b+='            <li id="'+a[c]["id"]+'" onmouseover="h(this)" onmouseout="o(this)" onmousedown="d(this)">                <div class="name">                    <div class="sn" onmousedown="sd(this)"></div>                    <div class="nl">'+a[c]["name"]+'</div>                </div>                <div class="pl">'+a[c]["phone"]+'</div>                <div class="bl">'+a[c]["loc"]+"</div>            </li>"}parent.iframeSetContactNum(a.length);document.getElementById("contact_list").innerHTML=b;selectFirstContact();document.getElementById("loadding").style.display="none"}else{parent.iframeSetContactNum("0");$("#searchEvent").attr("disabled","disabled");document.getElementById("fail").style.display="block"}}function setSearchContacts(a){var f=$("#contact_list");if(a!=""&&a!=null){var b="";var c=a.length;if(c==1){b='<div id="-1" style="padding-left:10px;height:25px;line-height:25px;">搜索到 0 个联系人</div>'}else{c=c-1;b='<div id="-1" style="padding-left:10px;height:25px;line-height:25px;">搜索到 '+c+" 个联系人</div>"}for(var e=1;e<a.length;e++){b+='            <li id="'+a[e]["id"]+'" onmouseover="h(this)" onmouseout="o(this)" onmousedown="d(this)">                <div class="name">                    <div class="sn" onmousedown="sd(this)"></div>                    <div class="nl">'+a[e]["name"]+'</div>                </div>                <div class="pl">'+a[e]["phone"]+'</div>                <div class="bl">'+a[e]["loc"]+"</div>            </li>"}document.getElementById("contact_list").innerHTML=b;selectFirstContact()}else{document.getElementById("contact_list").innerHTML='<li id="-1" style="padding-left:10px;height:25px;line-height:25px;">没有搜索结果</li>'}}function setContactSortLetter(a){a='<table cellspacing="0" cellpadding="0" height="100%" onselectstart="return false;" >'+a+"</table>";document.getElementById("leter").innerHTML=a;$("#leter").find("td").unbind("hover").unbind("click").hover(function(){$(this).addClass("leter_over");$(this).css("color","#FFF")},function(){$(this).removeClass("leter_over");$(this).css("color","#000")}).click(function(){var g=$(this).attr("mao");if(g==""||g=="#"){return}var f=document.getElementById(g);var e=getTop(f)-61;var c=$("#contact_list");var b=$(f);document.getElementById("contact_list").scrollTop=e;c.find(".sn").removeClass("select_on");c.find("li").css("background","");b.find(".sn").addClass("select_on");b.css("background","#FFF url(../../../contact/images/contactClick_bg.png) 0 0 repeat-x");checkAllSel();setTopmenu();cef.param=g;cef.cloud("getContactById")})}function selectFirstContact(){var a=global.contactListObj.find("li:first");if(a.length>0){a.css("background","#FFF url(../../../contact/images/contactClick_bg.png) 0 0 repeat-x");a.find(".sn").addClass("select_on");cef.param=a.attr("id");cef.cloud("getContactById")}checkAllSel();setTopmenu()}function getTop(a){var b=0;while(a){b+=a.offsetTop;a=a.offsetParent}return b}function h(a){a.style.backgroundColor="#B7DBEA";a.focus()}function o(a){a.style.backgroundColor="transparent"}function d(c){var b=$(c);var f=event||window.event;var a=global.contactListObj.find("li");a.css("background","");a.find(".select_on").removeClass("select_on");c.style.background="#FFF url(../../../contact/images/contactClick_bg.png) 0 0 repeat-x";b.find(".sn").addClass("select_on");if(global.contactListObj.find(".sn").length!=global.contactListObj.find(".select_on").length){document.getElementById("allSelect").className="sn"}else{document.getElementById("allSelect").className="sn select_on"}setTopmenu();cef.param=c.id;cef.cloud("getContactById")}function setContactDetail(b){$("#contactHead").empty();$("#contactName").text(b[0]["name"]);var c=document.getElementById("contactItemDetail");c.innerHTML=b[0]["html"];var a=$(c).find(".detail_item").length;if(a==1){c.firstChild.className="detail_sigle"}else{c.firstChild.className="detail_item detail_first";c.lastChild.className="detail_item detail_last"}}function checkAllSel(){if(global.contactListObj.find(".sn").length!=global.contactListObj.find(".select_on").length){document.getElementById("allSelect").className="sn"}else{if(global.contactListObj.find(".sn").length==0){document.getElementById("allSelect").className="sn"}else{document.getElementById("allSelect").className="sn select_on"}}}function allSd(b){cn=$(b);var a=global.contactListObj.find("li");if(a.length<=0){cn.removeClass("select_on");return}if(cn.hasClass("select_on")){b.className="sn";a.css("background","");a.find(".select_on").removeClass("select_on")}else{b.className="sn select_on";a.css("background","#FFF url(../../../contact/images/contactClick_bg.png) 0 0 repeat-x");a.find(".sn").addClass("select_on")}setTopmenu()}function sd(a){cn=$(a);if(cn.hasClass("select_on")){a.className="sn";var b=a.parentNode.parentNode;b.style.background="transparent"}else{a.className="sn select_on";var b=a.parentNode.parentNode;b.style.background="#FFF url(../../../contact/images/contactClick_bg.png) 0 0 repeat-x";cef.param=a.parentNode.parentNode.id;cef.cloud("getContactById")}if(global.contactListObj.find(".sn").length!=global.contactListObj.find(".select_on").length){document.getElementById("allSelect").className="sn"}else{document.getElementById("allSelect").className="sn select_on"}setTopmenu();var c=event||window.event;stopBubble(c)}function setTopmenu(){var a=$("#contact_list").find(".select_on").length;if(a>0){$("#saveContacts").removeClass("disable");if(parent.checkConnectPhone()=="1"){document.getElementById("import2Phone").className="menu-nav"}else{document.getElementById("import2Phone").className="menu-nav disable"}}else{$("#saveContacts").addClass("disable");$("#import2Phone").addClass("disable")}}function setLoadingText(a){document.getElementById("loadding").innerText=a};