window.onload=function(){var a={fun:1};cef.theme(a)};Array.prototype.remove=function(a){for(i in this){if(this[i].toString()==a.toString()){this.splice(i,1)}}};Array.prototype.clear=function(){this.splice(0,this.length)};Array.prototype.find=function(a){return(this.indexOf(a)!==-1)};function Sidebar(){var a=new Object();a.id="";a.name="";a.phone="";a.img1="";a.img2="";a.ishidden=true;this.getName=function(){return a.name};this.getPhone=function(){return a.phone};this.getId=function(){return a.id};this.isHidden=function(){return a.ishidden};this.setDetails=function(d,c,b){a.id=d;a.name=c;a.phone=b};this.show=function(d,c){a.img1=d;a.img2=c;$("#detailN").text(a.name);if(a.ishidden===true){$("#sidebar").show();$("#sidebar").animate({left:"+=350px"},"slow");a.ishidden=false}var b='<a><img src="'+d+'" /></a><a><img src="'+c+'" /></a>';document.getElementById("iconIMg").innerHTML=b;$("#slides").slides({preload:true,preloadImage:"../app/detail/img/loading.gif",play:5000,pause:2500,hoverPause:true,generatePagination:false})};this.hide=function(){a.id="";a.name="";a.phone="";a.img1="";a.img2="";a.ishidden=true;$("#sidebar").animate({left:"-=350px"},"slow",function(){$("#sidebar").hide();document.getElementById("iconIMg").innerHTML=""})}}var tabarray=new Array(3);var gselsTab=new Array(3);var gSelsCur;var modelpageIndex=new Array();var g_using="";var g_loading=false;var sidebar=new Sidebar();if(typeof Type=="undefined"){var Type={Official:0,Recommend:1,Hot:2}}var nType;var state;var nIndex;$(document).ready(function(){$.event.props=$.event.props.join("|").replace("layerX|layerY|","").split("|");$("#tab3").css({"background-image":"url(images/tabbg3.png)","font-weight":"bold",color:"#0772BE"});tabarray.tab1=$("#tabContent1");tabarray.tab2=$("#tabContent2");tabarray.tab3=$("#tabContent3");gselsTab.tab1=new Array();gselsTab.tab2=new Array();gselsTab.tab3=new Array();gSelsCur="tab3";$(".tabnav > li > a").click(function(){$(".tabnav > li > a").css({"background-image":"","font-weight":"normal",color:"#555"});$(this).css({"background-image":"url(images/tabbg3.png)","font-weight":"bold",color:"#0772BE"});$(".tabContent > div").hide();tabarray[$(this).attr("id")].show();gSelsCur=$(this).attr("id");if(gSelsCur=="tab1"){ResetRemoveModle()}});var a=$("#onlineContent");a.scroll(function(){var c=$("body");var b="";if(a.height()+a.scrollTop()>=a[0].scrollHeight){loadpage()}}).on("click",".themeLi .liMenu span",function(){perThemeMenuOnclickEvent(this)});$(window).bind("resize",function(b){window.resizeEvt;$(window).resize(function(){clearTimeout(window.resizeEvt);window.resizeEvt=setTimeout(function(){loadpage()},250)})});$("#returneditpage").click(function(){if(!$(this).hasClass("cls_btn_disable")){var b={fun:2,json:g_using};cef.theme(b)}}).hover(function(){if(!$(this).hasClass("cls_btn_disable")){$(this).addClass("adbg_top_hover")}},function(){$(this).removeClass("adbg_top_hover")}).mousedown(function(){if(!$(this).hasClass("cls_btn_disable")){$(this).addClass("adbg_top_clicked")}}).mouseup(function(){$(this).removeClass("adbg_top_clicked")});$("#removemodel").click(function(){if(!$(this).hasClass("cls_btn_disable")){var b=art.dialog({title:"卸载机型",content:"确定要卸载机型吗？",okValue:"确定",cancelValue:"取消",dblclickNotHide:true,ok:function(){this.content('<div class="dlgloading">正在卸载</div>');var d=JSON.stringify(gselsTab[gSelsCur]);var c=function(){if(gselsTab[gSelsCur].find(g_using)===true){g_using="";$("#returneditpage").addClass("cls_btn_disable")}gselsTab[gSelsCur].clear();b.time(500)};var e={fun:4,json:d,cb:c};cef.theme(e);return false},cancel:function(){return true},width:300,focus:true,lock:true})}});$(".cls_btn").hover(function(){if(!$(this).hasClass("cls_btn_disable")){$(this).addClass("cls_btn_hover")}},function(){$(this).removeClass("cls_btn_hover");$(this).removeClass("cls_btn_click")}).mousedown(function(){if(!$(this).hasClass("cls_btn_disable")){$(this).addClass("cls_btn_click")}}).mouseup(function(){$(this).removeClass("cls_btn_click")});$("#addmodel").click(function(){if($(this).hasClass("cls_btn_disable")){return}var b=gselsTab[gSelsCur][0];art.dialog({id:"installdlg",title:"正在安装机型"+b,content:document.getElementById("processScript").innerHTML,cancelValue:"取消",dblclickNotHide:true,cancel:function(){$("#tabContent2 .snEx").removeClass("select_on");var d={fun:6,json:""};cef.theme(d);CancelDownLoad();return true},width:300,focus:true,lock:true});var c={fun:3,json:b};cef.theme(c)});$("#hideSidebar").click(function(){sidebar.hide()});$(".select_box").click(function(c){c.stopPropagation();if($(this).attr("id")=="typeMenu"){$(this).find(".option").toggle();$(this).parent().siblings().find(".option").hide()}else{if($(this).attr("id")=="phoneMenu"){var f=$("#leftClick");if(f.css("display")=="block"){f.hide();return}if(g_loading){var d=window.event;var b=d.clientX+5;var g=d.clientY-5;fillModelList(modelpageIndex,$("#phoneSelect").text())}}}});$(document).click(function(c){var b=$(c.target);if($("#typeMenu").is(":visible")&&b.attr("class")!="option"&&!b.parent(".option").length){$(".option").hide()}});$(".option a").click(function(){var g=$(this).text();var f=$(this).attr("value");$(this).parent().siblings(".select_txt").text(g);var c=$("#phoneSelect").text();if(c==""){return}if(f==="official"){nType=Type.Official}else{if(f==="recommend"){nType=Type.Recommend}else{nType=Type.Hot}}$("#loadingtip").show();nIndex=0;var e={phone:c,type:nType,index:nIndex};var b=JSON.stringify(e);var d={fun:8,json:b};cef.theme(d)});$("#download").click(function(){if(!$(this).hasClass("cls_btn_disable")){$(this).addClass("cls_btn_disable");var e=sidebar.getPhone();var j=sidebar.getId();var f=sidebar.getName();var h=document.getElementById("downloadBubble");$("#downloadBubbleTxt > span").text(f);h.style.display="block";setTimeout(function(){h.style.display="none"},2000);var g=document.getElementById(j);$(g).addClass("disable");$(g).text("下载中");$("#apply").addClass("cls_btn_disable");var d={phone:e,id:j,apply:false};var b=JSON.stringify(d);var c={fun:10,json:b};cef.theme(c)}});$("#apply").click(function(){if(!$(this).hasClass("cls_btn_disable")){$(this).addClass("cls_btn_disable");var e=sidebar.getPhone();var j=sidebar.getId();var g=sidebar.getName();var d={phone:e,id:j,name:g,apply:true};var c=JSON.stringify(d);var b=function(k){if(k===""){art.dialog({title:"应用主题",content:"<div >当前没有手机连接，无法应用</div>",okValue:"确定",ok:function(){return true},width:300,focus:true,dblclickNotHide:true,lock:true})}else{$(this).addClass("cls_btn_disable");var l=document.getElementById("downloadBubble");$("#downloadBubbleTxt > span").text(sidebar.getName());l.style.display="block";setTimeout(function(){l.style.display="none"},2000)}};var h=document.getElementById(j);$(h).addClass("disable");if($(h).text()=="下载"){$(h).text("下载中")}$("#download").addClass("cls_btn_disable");var f={fun:11,json:c,cb:b};cef.theme(f)}})});function loadpage(){if(state===false){$("#loadingtip").show();nIndex=nIndex+12;var b=$("#phoneSelect").text();var d={phone:b,type:nType,index:nIndex};var a=JSON.stringify(d);var c={fun:8,json:a};cef.theme(c)}}function setDownloadPhoneProcess(a){$("#nDone").text(a.text);$("#process").width(a.width)}function DownloadPhoneFinish(){gselsTab[gSelsCur].shift();var a=gselsTab[gSelsCur][0];if(a!==undefined){art.dialog.get("installdlg").title("安装机型("+a+")");var b={fun:3,json:a};cef.theme(b)}else{art.dialog.get("installdlg").close()}}function imgclick(c){var d=document.getElementById(g_using);if(d!==null){$(d).parent().parent().removeClass("using")}$(c).parent().addClass("using");var a=$(c).next().find(".name").text();a=a.substring(3);g_using=a;var b={fun:2,json:a,cb:function(){$("#bubble_message").html("正在载入机型，请稍等……");$("#bubble").show()}};cef.theme(b)}function phoneNameClick(b){var a=b.innerHTML;stopBubble(b);$(b).parent().hide();$("#loadingtip").show();if(!sidebar.isHidden()){sidebar.hide()}setTimeout(function(){$("#phoneSelect").text(a);nIndex=0;var e={phone:a,type:nType,index:nIndex};var c=JSON.stringify(e);var d={fun:8,json:c};cef.theme(d)},400)}function sc(a){var e=$(a);var d=e.parents(".Content");var b=$($(d).parents()).attr("id");if(!e.hasClass("select_on")){e.addClass("select_on");gselsTab[gSelsCur].push(a.id);$("#"+b+" .cls_btn").removeClass("cls_btn_disable");var c=d.find(".sn").length-d.find(".select_on").length;if(c===0){d.parent().children(".ContentTop").children(".snEx").addClass("select_on")}}else{e.removeClass("select_on");gselsTab[gSelsCur].remove(a.id);d.parent().children(".ContentTop").children(".snEx").removeClass("select_on");if(d.find(".select_on").length===0){$("#"+b+" .cls_btn").addClass("cls_btn_disable")}}}function selectall(a){var d=$(a);var b=$(d).parent().parent();var c=b.find(".Content");gselsTab[gSelsCur].clear();if(!d.hasClass("select_on")){d.addClass("select_on");c.find(".sn").each(function(){$(this).addClass("select_on");gselsTab[gSelsCur].push(this.id)});if(gselsTab[gSelsCur].length!==0){b.find(".cls_btn").removeClass("cls_btn_disable")}}else{d.removeClass("select_on");c.find(".sn").removeClass("select_on");b.find(".cls_btn").addClass("cls_btn_disable")}}function searchChange(c){var b=c.value;var f=window.event;if(f.keyCode==13){b=b.toLowerCase(b);b=unescape(b);var a=JSON.stringify({tab:gSelsCur,key:b});var d={fun:7,json:a};cef.theme(d);return false}else{if(b===""){var a=JSON.stringify({tab:gSelsCur,key:""});var d={fun:7,json:a};cef.theme(d)}}}function hide_popup(){$(".waitdiv").hide()}function firstadd(a){$(a).addClass("first_btn_press");$("#tab2").click();$(".wunaidediv").css("display","inline")}function firstadd_over(a){$(a).addClass("first_btn_hover")}function firstadd_out(a){$(a).removeClass("first_btn_hover");$(a).removeClass("first_btn_press")}function enableReturnBtn(a){$("#returneditpage").removeClass("cls_btn_disable")}function disableReturnBtn(){$("#returneditpage").addClass("cls_btn_disable");$("#removemode").addClass("cls_btn_disable");$("#sn_all").removeClass("select_on");$(".wunaidediv").css("display","none")}function showbubble(a){$("#bubble_message").html(a);$("#bubble").css("display","inline");window.setTimeout(function(){$("#bubble").css("display","none")},1500)}function HandleDownError(a){console.error("download error type: "+a.type);switch(a.type){case 0:var c=tabarray.tab3.find(".Content");var b;b='<div class="init_text">网络异常,请检查您的网络连接是否正常！&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button class="normal_btn" data-tab="3" onclick=reload(this)>刷新</button></div>';c.html(b);break;case 5:var c=tabarray.tab2.find(".Content");var b;b='<div class="init_text">网络异常，请检查您的网络连接是否正常！&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button class="normal_btn" data-tab="2" onclick=reload(this)>刷新</button></div>';c.html(b);break;case 4:$("#d-content-installdlg .processbg").hide();$("#nDone").text("网络异常,机型下载失败!");break;default:break}}function fillContent(g){var d=g.tab;var f=g.list;var e=tabarray[d].find(".Content");var b;var a;if(f===null||f.length===0){if(d==="tab1"){b='<div class="init_text">还没有安装任何机型，赶快来添加吧！</div><div id="addfirstbtn" class="first_btn" onclick=firstadd(this) onmouseover=firstadd_over(this) onmouseout=firstadd_out(this) >添加机型</div>'}else{if(d==="tab2"){b=""}else{}}tabarray[d].find(".snEx").removeClass("select_on").hide()}else{tabarray[d].find(".snEx").show();if(d==="tab1"){a='<ul><% for (var i = 0; i < list.length; i ++) { %><li class="<%= list[i]["using"] %> phoneLi" ><img onclick=imgclick(this) src="<%= list[i]["img"] %>"/><div class="liMenu"><%if(gselsTab["tab1"].find(list[i]["name"]) === true) {%><div id="<%= list[i]["name"] %>" class="sn select_on" onclick=sc(this)><div class="name">机型：<%= list[i]["name"] %></div>大小：<%= list[i]["size"] %></div><%} else {%><div id="<%= list[i]["name"] %>" class="sn" onclick=sc(this)><div class="name">机型：<%= list[i]["name"] %></div>大小：<%= list[i]["size"] %></div><%} %></div></li><% } %></ul>'}else{if(d==="tab2"){a='<ul><% for (var i = 0; i < list.length; i ++) { %><li class="phoneLi"><img src="<%= list[i]["img"] %>" /><div class="liMenu"><%if(gselsTab["tab2"].find(list[i]["name"]) === true) {%><div id="<%= list[i]["name"] %>" class="sn select_on" onclick=sc(this)><div class="name">机型：<%= list[i]["name"] %></div>大小：<%= list[i]["size"] %></div><%} else {%><div id="<%= list[i]["name"] %>" class="sn" onclick=sc(this)><div class="name">机型：<%= list[i]["name"] %></div>大小：<%= list[i]["size"] %></div><%} %></div></li><% } %></ul>'}else{}}var c=template.compile(a);b=c({list:f,gselsTab:gselsTab})}e.html(b);if(e.find(".select_on").length<e.find(".sn").length){tabarray[d].find(".snEx").removeClass("select_on")}else{tabarray[d].find(".snEx").addClass("select_on")}if(e.find(".select_on").length!=0){if(d=="tab1"){$("#removemodel").removeClass("cls_btn_disable")}else{if(d=="tab2"){$("#addmodel").removeClass("cls_btn_disable")}}}else{if(d=="tab1"){$("#removemodel").addClass("cls_btn_disable")}else{if(d=="tab2"){$("#addmodel").addClass("cls_btn_disable")}}}}function fillOnlineThemeModel(b){$("#unConected").hide();$("#phoneSelect").text("");$("#typeSelect").text("官方推荐");if(b[0]==""){var e=tabarray.tab3.find(".Content");var c;c='<div class="centerTips">对不起，vivo手机助手不提供该机型的主题，请到手机端“i主题”获取该机型的主题！</div>';e.html(c);return}g_loading=true;modelpageIndex=b;$("#phoneSelect").text(modelpageIndex[modelpageIndex.length-1]);var f={phone:modelpageIndex[modelpageIndex.length-1],type:0,index:0};var a=JSON.stringify(f);var d={fun:8,json:a};cef.theme(d)}function connectNotify(a){if(a){$("#unConected").hide()}else{$("#unConected").show()}}function fillModelList(e,d){var a='<% for (var i = 0; i < list.length; i ++) { %><div onclick=phoneNameClick(this) class="modellist<% if (name==list[i]) {%> selected<%}%>"><%= list[i] %></div><% } %>';var c=template.compile(a);var b=c({list:e,name:d});$("#leftClick").html(b)}function fillOnlineThemeContent(e){nType=e.type;state=e.state;nIndex=e.index;var d=e.list;var a;if(d===null||d.length===0){a='<div class="noContent">当前无主题</div>'}else{a='<ul><% for (var i = 0; i < list.length; i ++) { %><li class="themeLi"><img class="onlineimg" onclick=imgPreviewclick(this) src="<%= list[i]["iconurl"] %>"/><% if(list[i]["status"]=== 2) {%><div class="liMenu"><div class="name"><%= list[i]["name"] %></div><span id="<%= list[i]["id"] %>">应用</span></div><%}else if(list[i]["status"]=== 1) {%><div class="liMenu"><div class="name"><%= list[i]["name"] %></div><span id="<%= list[i]["id"] %>"class="disable">下载中</span></div><%}else{%><div class="liMenu"><div class="name"><%= list[i]["name"] %></div><span id="<%= list[i]["id"] %>">下载</span></div><%}%></li><% } %></ul>'}var c=template.compile(a);var b=c({list:d,type:nType});if(nIndex===0){$("#onlineContent").html(b)}else{$("#onlineContent").append(b)}setTimeout(function(){$("#loadingtip").hide("fast")},1000)}function imgPreviewclick(f){var k=$(f).next();var a=k.find(".name").text();var h=$("#phoneSelect").text();var c=k.find("span");var b=c.attr("id");if(b!=sidebar.getId()){if($("#download").hasClass("cls_btn_disable")){$("#download").removeClass("cls_btn_disable")}else{if(c.hasClass("disable")){$("#download").addClass("cls_btn_disable")}}}sidebar.setDetails(b,a,h);var e={phone:h,id:b};var j=JSON.stringify(e);var d=function(l){var m=jQuery.parseJSON(l);sidebar.show(m.img1,m.img2);if(m.status==1||m.status==2){$("#download").addClass("cls_btn_disable")}else{$("#download").removeClass("cls_btn_disable")}if(m.status==1){$("#apply").addClass("cls_btn_disable")}else{$("#apply").removeClass("cls_btn_disable")}};var g={fun:9,json:j,cb:d};cef.theme(g)}function fillDetail(a){sidebar.show(a.img1,a.img2);if(a.status==1||a.status==2){$("#download").addClass("cls_btn_disable")}else{$("#download").removeClass("cls_btn_disable")}if(a.status==1){$("#apply").addClass("cls_btn_disable")}else{$("#apply").removeClass("cls_btn_disable")}}function perThemeMenuOnclickEvent(a){if($(a).text()=="下载"){downloadonline(a)}else{if($(a).text()=="应用"){applyTheme(a)}}}function downloadonline(f){if(!$(f).hasClass("disable")){$(f).addClass("disable");$(f).text("下载中");var e=$(f).prev().text();var h=document.getElementById("downloadBubble");$("#downloadBubbleTxt > span").text($(f).prev().text());h.style.display="block";setTimeout(function(){h.style.display="none"},2000);var d=$("#phoneSelect").text();var g=f.id;if(g===sidebar.getId()){$("#download").addClass("cls_btn_disable");$("#apply").addClass("cls_btn_disable")}var c={phone:d,id:g,name:e,apply:false};var a=JSON.stringify(c);var b={fun:10,json:a};cef.theme(b)}return false}function applyTheme(g){var d=$("#phoneSelect").text();var h=g.id;var f=$(g).prev().text();var c={phone:d,id:h,name:f,apply:true};var b=JSON.stringify(c);var a=function(j){if(j===""){art.dialog({title:"应用主题",content:"<div >当前没有手机连接，无法应用</div>",okValue:"确定",ok:function(){return true},width:300,focus:true,dblclickNotHide:true,lock:true})}else{$(this).addClass("disable");var k=document.getElementById("downloadBubble");$("#downloadBubbleTxt > span").text(f);k.style.display="block";setTimeout(function(){k.style.display="none"},2000)}};var e={fun:11,json:b,cb:a};cef.theme(e)}function downloadItzSucess(d){var c=d.id;var a=d.phone;var b=d.bCancel;if($("#phoneSelect").text()===a){$("#"+c).removeClass("disable");if(b){$("#"+c).text("下载")}else{$("#"+c).text("应用")}}if(sidebar.getId()===c){if(!b){$("#download").addClass("cls_btn_disable")}else{$("#download").removeClass("cls_btn_disable")}}$("#apply").removeClass("cls_btn_disable")}function enableApply(a){$("#"+a.id).removeClass("disable");$("#apply").removeClass("cls_btn_disable")}function stopBubble(a){if(a&&a.stopPropagation){a.stopPropagation()}else{window.event.cancelBubble=true}}document.oncontextmenu=new Function("return false;");document.onclick=function(b){var c=b||window.event;var a=c.srcElement||c.target;while(a){if(a!=document){if(a.id==="phoneMenu"){return}a=a.parentNode}else{$("#leftClick").hide();return}}};function CancelDownLoad(){gselsTab[gSelsCur].clear();var b=document.getElementById("tabContent2");var a=$(b).find(".Content");a.find(".sn").removeClass("select_on");$(b).find(".cls_btn").addClass("cls_btn_disable")}function ResetRemoveModle(){var d=document.getElementById("removemodel");var c=document.getElementById("tabContent1");var b=$(c).find(".Content");var a=0;a=b.find(".select_on").length;console.log("number = "+a);if(a==0){$(d).addClass("cls_btn_disable")}}function reload(a){$(a).parent().parent().html('<div class="loading">正在加载</div>');var b={fun:1,json:$(a).attr("data-tab")};cef.theme(b)}function updateItemState(a){var b=a.name;var f=b.lastIndexOf("_");var d=b.lastIndexOf(".");b=b.substring(f+1,d);var e=$(".themeLi .liMenu .name");for(var c=0;c<e.length;c++){if($(e[c]).text()===b){$(e[c]).next().text("下载");break}}};