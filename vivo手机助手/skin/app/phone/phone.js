$(document).ready(function(){$.event.props=$.event.props.join("|").replace("layerX|layerY|","").split("|");listEvent();buttonEvent();setMenuButton()});document.oncontextmenu=new Function("return false;");window.onload=function(){parent.iframeGetPhoneApp()};function listEvent(){$("li").unbind("hover").hover(function(){if(!$(this).hasClass("liOn")){$(this).addClass("liOver")}},function(){if(!$(this).hasClass("liOn")){$(this).removeClass("liOver")}}).unbind("mousedown").mousedown(function(){$("li").removeClass("liOn");$("li").find(".sel").removeClass("selOn");$(this).addClass("liOn").removeClass("liOver");$(this).find(".sel").addClass("selOn");var b=0,a=0;b=$(".selOn").length;a=$(".sel").length;if(b==a&&b!=0&&a!=0){$("#selAll").addClass("selAllOn")}else{$("#selAll").removeClass("selAllOn")}setMenuButton()});$(".sel").unbind("mousedown").mousedown(function(){var c=$(this);if(c.hasClass("selOn")){c.removeClass("selOn");c.parent().removeClass("liOn").addClass("liOver")}else{c.addClass("selOn");c.parent().addClass("liOn").removeClass("liOver")}var b=0,a=0;b=$(".selOn").length;a=$(".sel").length;if(b==a&&b!=0&&a!=0){$("#selAll").addClass("selAllOn")}else{$("#selAll").removeClass("selAllOn")}setMenuButton();return false});$("#selAll").unbind("mousedown").mousedown(function(){var a=$("li");if($(this).hasClass("selAllOn")){$(this).removeClass("selAllOn");a.removeClass("liOn");a.find(".sel").removeClass("selOn")}else{$(this).addClass("selAllOn");a.addClass("liOn");a.find(".sel").addClass("selOn")}setMenuButton();return false})}function buttonEvent(){$(".canUpdateBtn").unbind("mousedown").mousedown(function(){var f=$(this);f.unbind("mousedown");f.removeClass("canUpdateBtn");f.text("升级中");alert("sd");var e="";var a=$(this).parent().parent();var d=a.attr("id");var b=a.find(".appRealName").text();var c=$(this).attr("uurl");e='[{"packageName":"'+d+'", "appName":"'+b+'", "downloadUrl":"'+c+'"}]';alert(e);parent.iframeDownloadApp(e);return false});$(".uninstallBtn").unbind("mousedown").mousedown(function(){var e=$(this);var d="";var a=$(this).parent().parent();var c=a.attr("id");var b=a.find(".appRealName").text();d='[{"pkgName":"'+c+'", "name":"'+b+'"}]';alert(d);parent.iframeUninstallApp(d);return false});$(".moveToBtn").unbind("mousedown").mousedown(function(){if($(this).hasClass("moveToDisable")){return}var f=$(this);var d="";var a=$(this).parent().parent();var c=a.attr("id");var b=a.find(".appRealName").text();var e=a.find(".moveToBtn").attr("loc");if(e=="1"){e=2}else{if(e=="2"){e=1}else{return}}d='[{"pkgName":"'+c+'", "name":"'+b+'","toLoc":'+e+"}]";alert(d);parent.iframeMoveApp(d);return false});$(".del").hover(function(){$(this).addClass("delOn")},function(){$(this).removeClass("delOn")})}function installLocal(){$("#installAppPop").show()}function uninstallApp(c){if($(c).hasClass("disable")){return}var a="";var b=0;$("#applist").find(".selOn").each(function(){var e=$(this).parent().attr("id");var d=$(this).next().find(".appRealName").text();if(b==0){a='{"pkgName":"'+e+'", "name":"'+d+'"}'}else{a+=',{"pkgName":"'+e+'", "name":"'+d+'"}'}b++});a="["+a+"]";alert(a);parent.iframeUninstallApp(a)}function updateApp(c){if($(c).hasClass("disable")){return}var a="";var b=0;$("#applist").find(".selOn").each(function(){var d=$(this).parent();var g=d.attr("id");var e=$(this).next().find(".appRealName").text();var f=d.find(".updateBtn").attr("uurl");if(d.find(".canUpdateBtn").length!=0){if(b==0){a='{"packageName":"'+g+'", "appName":"'+e+'", "downloadUrl":"'+f+'"}'}else{a+=',{"packageName":"'+g+'", "appName":"'+e+'", "downloadUrl":"'+f+'"}'}b++}});a="["+a+"]";alert(a);parent.iframeDownloadApp(a);return false}function setMenuButton(){var b=$("#applist").find(".liOn").length;var a=$("#applist").find(".liOn").find(".canUpdateBtn").length;if(b>0){$("#uninstallApp").removeClass("disable")}else{$("#uninstallApp").addClass("disable")}if(a>0){$("#updateApp").removeClass("disable")}else{$("#updateApp").addClass("disable")}}function setInstalledAll(a){alert("ok")}function setInstalledApp(a){var e=$("#applist");if(a!=""&&a!=null){var c="";for(var d=0;d<a.length;d++){var g,b;if(a[d]["installloc"]==1){g="手机内存";if(a[d]["move"]==1){b='<div class="moveToBtn" loc="1">移至SD卡</div>'}else{b='<div class="moveToBtn moveToDisable" loc="0">不可移动</div>'}}else{if(a[d]["installloc"]==2){g="SD卡";if(a[d]["move"]==1){b='<div class="moveToBtn" loc="2">移至手机</div>'}else{b='<div class="moveToBtn moveToDisable" loc="0">不可移动</div>'}}else{g="未知";b='<div class="moveToBtn moveToDisable" loc="0">不可移动</div>'}}var f,h;if(a[d]["newver"]!=-1){f=a[d]["newver"];h='<div class="updateBtn canUpdateBtn" uurl="'+a[d]["uurl"]+'">升级</div>'}else{f="--";h='<div class="updateBtn">升级</div>'}c+='<li id="'+a[d]["pkgname"]+'">            <div class="sel"></div>            <div class="appName">                <div class="appIcon"><img src="'+a[d]["icon"]+'"/></div>                <div class="appRealName">'+a[d]["name"]+'</div>                <div class="appVersion">'+a[d]["ver"]+'</div>            </div>            <div class="splitEmpty"></div>            <div class="appSize">'+a[d]["size"]+'</div>            <div class="splitEmpty"></div>            <div class="appPosition">'+g+'</div>            <div class="splitEmpty"></div>            <div class="appCurr">'+f+'</div>            <div class="splitEmpty"></div>            <div class="appOP">'+h+b+'<div class="uninstallBtn">卸载</div>            </div>        </li>'}e.html(c)}listEvent();buttonEvent();document.getElementById("loadding").style.display="none"}function uninstallOneDone(b){var a=document.getElementById(b);alert(a);a.parentNode.removeChild(a)}function moveOneDone(c,b){var a=document.getElementById(c);alert("_div="+a);alert("csLoc="+b);alert("cspkgname="+c);if(a!=null){alert("dive!=null");var e=$(a).find(".appPosition");var d=$(a).find(".moveToBtn");if(b=="1"){alert("csLoc == 1");e.text("手机内存");d.text("移至SD卡");d.attr("loc","1")}else{if(b=="2"){alert("csLoc == 2");e.text("SD卡");d.text("移至手机");d.attr("loc","2")}else{alert("csLoc == x");e.text("未知");d.text("不可移动");d.attr("loc","0");d.addClass("moveToDisable")}}}}function newInstall(a){if(a!=""&&a!=null){var c="";if(a[0]["app"]!=""){var g,b;if(a[0]["app"][0]["installloc"]==1){g="手机内存";if(a[0]["app"][0]["move"]==1){b='<div class="moveToBtn" loc="1">移至SD卡</div>'}else{b='<div class="moveToBtn moveToDisable" loc="0">不可移动</div>'}}else{if(a[0]["app"][0]["installloc"]==2){g="SD卡";if(a[0]["app"][0]["move"]==1){b='<div class="moveToBtn" loc="2">移至手机</div>'}else{b='<div class="moveToBtn moveToDisable" loc="0">不可移动</div>'}}else{g="未知";b='<div class="moveToBtn moveToDisable" loc="0">不可移动</div>'}}var f,h;if(a[0]["app"][0]["newver"]!=-1){f=a[0]["app"][0]["newver"];h='<div class="updateBtn canUpdateBtn" uurl="'+a[0]["app"][0]["uurl"]+'">升级</div>'}else{f="--";h='<div class="updateBtn">升级</div>'}c+='<li id="'+a[0]["app"][0]["pkgname"]+'">                <div class="sel"></div>                <div class="appName">                    <div class="appIcon"><img src="'+a[0]["app"][0]["icon"]+'"/></div>                    <div class="appRealName">'+a[0]["app"][0]["name"]+'</div>                    <div class="appVersion">'+a[0]["app"][0]["ver"]+'</div>                </div>                <div class="splitEmpty"></div>                <div class="appSize">'+a[0]["app"][0]["size"]+'</div>                <div class="splitEmpty"></div>                <div class="appPosition">'+g+'</div>                <div class="splitEmpty"></div>                <div class="appCurr">'+f+'</div>                <div class="splitEmpty"></div>                <div class="appOP">'+h+b+'<div class="uninstallBtn">卸载</div>                </div>            </li>'}else{return}var d=a[0]["list"];if(d!="1"){var e=document.getElementById(d);if($(e).length>0){$(e).before(c)}else{$("#applist").append(c)}}else{$("#applist").append(c)}listEvent();buttonEvent()}}function updateInstall(b){alert(b);if(b!=""&&b!=null){var d=document.getElementById(b[0]["pkgname"]);var a=$(d);if(a.length>0){a.find(".appIcon").find("img").attr("src",b[0]["icon"]);a.find(".appRealName").text(b[0]["name"]);a.find(".appVersion").text(b[0]["ver"]);a.find(".appSize").text(b[0]["size"]);var f=a.find(".appPosition");var c=a.find(".moveToBtn");if(b[0]["installloc"]==1){f.text("手机内存");if(b[0]["move"]==1){c.removeClass("moveToDisable").text("移至SD卡").attr("loc","1")}else{c.addClass("moveToDisable").text("不可移动").attr("loc","0")}}else{if(b[0]["installloc"]==2){f.text("SD卡");if(b[0]["move"]==1){c.removeClass("moveToDisable").text("移至手机").attr("loc","2")}else{c.addClass("moveToDisable").text("不可移动").attr("loc","0")}}else{f.text("未知");c.addClass("moveToDisable").text("不可移动").attr("loc","0")}}var e,g;var e=a.find(".appCurr");var g=a.find(".updateBtn");if(b[0]["newver"]!=-1){e.text(b[0]["newver"]);g.addClass("canUpdateBtn").text("升级");g.attr("uurl",b[0]["uurl"])}else{e.text("--");g.removeClass("canUpdateBtn").text("升级")}}}};