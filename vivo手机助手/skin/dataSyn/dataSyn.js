$(document).ready(function(){$.event.props=$.event.props.join("|").replace("layerX|layerY|","").split("|");function a(){$(".content").hide();$("#bubble").hide();$("#synContact").show()}a();$(".category-list").click(function(){var c=$(this).find(".category-sel");if(c.hasClass("noUse")){return}if(c.hasClass("category-selOn")){c.removeClass("category-selOn");var b=$(".category-selOn").length;if(b<=0){if(global.bDataSyn&&$(".loading").length==0){canNotUseSynButton()}}}else{c.addClass("category-selOn");if(global.bDataSyn&&$(".loading").length==0){canUseSynButton()}else{canUseSynButton()}}});$(".category").hover(function(){if($(this).css("background-position-y")!="-105px"){$(this).css("background-position-y","-35px")}},function(){if($(this).css("background-position-y")!="-105px"){$(this).css("background-position-y","0px")}}).mousedown(function(){if($(this).css("background-position-y")!="-105px"){$(this).css("background-position-y","-70px")}}).mouseup(function(){$(".category").css("background-position-y","0px")});$("#refresh").hover(function(){$(this).addClass("menu-nav-on")},function(){$(this).removeClass("menu-nav-on");$(this).removeClass("menu-nav-down")}).mousedown(function(){$(this).removeClass("menu-nav-on");$(this).addClass("menu-nav-down")}).mouseup(function(){$(this).removeClass("menu-nav-down");$(this).removeClass("menu-nav-on")});$("#select").click(function(){var f=$("#select");var e=$("#select-list");var b=f.position();var d=parseInt(f.css("marginLeft"));var c=parseInt(f.css("marginTop"));e.css("position","absolute");e.css("left",b.left+d+"px");e.css("top",b.top+c+f.height()+"px");if(e.css("display")!="none"){e.hide()}else{e.show()}});$("#select-list").find("div").click(function(){$("#select").text($(this).text());$(this).parent().hide()});$(".button").hover(function(){if($(this).hasClass("disable")){return}$(this).addClass("button_on")},function(){if($(this).hasClass("disable")){return}$(this).removeClass("button_on").removeClass("button_click")}).mousedown(function(){if($(this).hasClass("disable")){return}$(this).addClass("button_click").removeClass("button_on")}).mouseup(function(b){if($(this).hasClass("disable")){return}$(this).removeClass("button_click")});$("#defaultButton").hover(function(){$(this).css("background-position-y","-25px")},function(){$(this).css("background-position-y","0px")}).mousedown(function(){$(this).css("background-position-y","-50px")}).mouseup(function(b){$(this).css("background-position-y","-25px")});$(".submitButton").hover(function(){if($(this).hasClass("disable")){return}$(this).css("background-position-y","-28px")},function(){if($(this).hasClass("disable")){return}$(this).css("background-position-y","0px")}).mousedown(function(){if($(this).hasClass("disable")){return}$(this).css("background-position-y","-56px")}).mouseup(function(){if($(this).hasClass("disable")){return}$(this).css("background-position-y","0px")});$("#no").click(function(){$("#prompt").hide();cef.dataSyn("stopDataSyn")});$(".close").hover(function(){if($(this).hasClass("disable")){return}$(this).css("background-position-x","-31px")},function(){if($(this).hasClass("disable")){return}$(this).css("background-position-x","0px")}).mousedown(function(){if($(this).hasClass("disable")){return}$(this).css("background-position-x","-62px")}).mouseup(function(){if($(this).hasClass("disable")){return}$(this).css("background-position-x","0px")}).click(function(){$("#prompt").hide();cef.dataSyn("stopDataSyn")});$(".radio").hover(function(){$(this).addClass("radio_on")},function(){$(this).removeClass("radio_on")}).click(function(){$(this).parent().children(".radio").removeClass("radio_check");$(this).addClass("radio_check")})});document.oncontextmenu=new Function("return false;");var global={bDataSyn:true,getOutlookTime:0,bConnected:false};function dataSyn(f){if($(f).hasClass("disable")){return}var h=f.id;var a=0;var e=0;if($("#contactSel").hasClass("category-selOn")){a=1}if($("#calendarSel").hasClass("category-selOn")){e=1}if(a==0&&e==0){return}var b=1;var c=$(".radio_check");if(c.hasClass("by_time")){b=1}else{if(c.hasClass("by_phone")){b=2}else{b=3}}var d=1;if($("#select").text()!="{{dataSyn_html_select_top_lang}}"){d=2}var g;if(h="synButton"){g='[{"radio":"'+b+'", "contact":"'+a+'", "calendar":"'+e+'", "rule":"'+d+'"}]'}$("#bubble").show();cef.param=g;cef.dataSyn("showSynDlg")}function getOutLook(){olHtml='<div class="loading"></div>{{dataSyn_html_loading_lang}}';$("#outlookNum").html(olHtml);canNotUseSynButton();cef.dataSyn("getOutLook")}function init(){canNotUseSynButton();var b='<div id="loadPhone"><div class="loading"></div>{{dataSyn_html_loading_lang}}</div>';var a='<div class="loading"></div>{{dataSyn_html_loading_lang}}';$("#phoneNum").html(b);$("#outlookNum").html(a)}function contactBusy(){var a='<div class="loading"></div>{{dataSyn_js_contact_operator_lang}}';$("#phoneContact").html(a);judeCanSyn()}function calendarBusy(){var a='<div class="loading"></div>{{dataSyn_js_calendar_operator_lang}}';$("#phoneCalendar").html(a);judeCanSyn()}function initOutlook(d){var a;var c=d[0].conNum;var b=d[0].calNum;global.bConnected=d[0].bConnect;if((c==-1||c==-2)&&global.getOutlookTime==0){global.getOutlookTime=1;getOutLook();return}global.bDataSyn=global.bConnected;if(c==-1){a='<div id="noUse">{{dataSyn_js_calendar_outlook_nonsupport_lang}}</font>';global.bDataSyn=false}else{if(c==-2){a='<div id="noUse">{{dataSyn_js_calendar_outlook_nonsetting_lang}}</font>';global.bDataSyn=false}else{a="<div>{{dataSyn_html_contact_lang}}: "+c+"</div>"}}if(global.bDataSyn==false){$("#contactSel").removeClass("category-selOn").addClass("noUse")}else{$("#contactSel").removeClass("noUse").addClass("category-selOn")}setTimeout(function(){$("#outlookNum").html(a);judeCanSyn()},1000)}function initCantact(b){console.log("initCantact "+b);var d=$("#phoneNum");var e=d.find("#phoneContact");var a=d.find("#phoneCalendar");if(e.length>0){e.html("{{dataSyn_html_contact_lang}}: "+b)}else{var c='<div id="phoneContact">{{dataSyn_html_contact_lang}}: '+b+"</div>";$("#loadPhone").remove();d.prepend(c)}judeCanSyn()}function initCalendar(a){return;console.log("initCalendar "+a);var c=$("#phoneNum");var d=c.find("#phoneCalendar");var e=c.find("#phoneContact");if(d.length>0){d.html("{{dataSyn_html_calendar_lang}}: "+a)}else{var b='<div id="phoneCalendar">{{dataSyn_html_calendar_lang}}: '+a+"</div>";if(e.length>0){$("#loadPhone").remove()}c.append(b)}judeCanSyn()}function dataSynSuccess(b){var a=$("#bubble");if(b==1){a.html('<div class="bubble">            <div class="bubble_top">            </div>            <div id="bubble_message" class="bubble_middle">                <div class="bubble_text"><div class="ok" ></div>{{dataSyn_js_calendar_syn_success_lang}}</div>            </div>            <div class="bubble_bottom">            </div>          </div>');setTimeout(function(){a.hide();a.html("")},1000);init()}else{a.hide();init()}cef.dataSyn("getOutlook")}function cantDataSyn(){$("#bubble").hide()}function cancelDataSyn(){$("#bubble").hide()}function judeCanSyn(){if($(".loading").length>0||$("#noUse").length>0){canNotUseSynButton()}else{if($("#contactSel").hasClass("category-selOn")||$("#calendarSel").hasClass("category-selOn")){canUseSynButton()}else{canNotUseSynButton()}}}function canNotUseSynButton(){$("#synButton").addClass("disable");$("#synButton_prompt").html('<div class="wrap">{{dataSyn_js_unavailable_lang}}</div>')}function canUseSynButton(){if(global.bConnected==true){$("#synButton").removeClass("disable");$("#synButton_prompt").html('<div class="wrap">{{dataSyn_js_available_lang}}</div>')}else{canNotUseSynButton()}}function defaultSet(){$("#synButton").addClass("disable");$(".category-sel").removeClass("category-selOn").addClass("noUse");$(".radio").removeClass("radio_check");$(".radio:first").addClass("radio_check");$("#select").text("{{dataSyn_html_select_top_lang}}")}function disConnect(){defaultSet();initCantact(0);initCalendar(0)};